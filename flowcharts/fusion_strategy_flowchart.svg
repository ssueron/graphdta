<svg xmlns="http://www.w3.org/2000/svg" width="3300" height="900" viewBox="0 0 3300 900">
  <defs>
    <style>
      .title { font: bold 30px 'Segoe UI', sans-serif; fill: #111827; }
      .label { font: 22px 'Segoe UI', sans-serif; fill: #111827; }
      .small { font: 20px 'Segoe UI', sans-serif; fill: #4b5563; }
      .box { stroke-width: 3; }
    </style>
    <marker id="arrow" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,12 L12,6 z" fill="#111827" />
    </marker>
  </defs>

  <!-- Titles -->
  <text x="400" y="90" class="title">Current Late Fusion</text>
  <text x="1720" y="90" class="title">Proposed Cross-Modal Fusion</text>

  <!-- Divider -->
  <line x1="1200" y1="70" x2="1200" y2="830" stroke="#9ca3af" stroke-width="2" stroke-dasharray="12 16" />
  <text x="1170" y="820" class="small">Evolution</text>

  <!-- Current model: ligand branch -->
  <g fill="#e0ecff" stroke="#2563eb" class="box">
    <rect x="80" y="170" width="260" height="140" rx="24" />
    <rect x="420" y="170" width="260" height="140" rx="24" />
    <rect x="760" y="170" width="240" height="140" rx="24" />
    <rect x="1080" y="170" width="260" height="140" rx="24" />
  </g>
  <text x="210" y="230" class="label" text-anchor="middle">SMILES Graph</text>
  <text x="210" y="260" class="label" text-anchor="middle">Nodes + Edges</text>
  <text x="550" y="230" class="label" text-anchor="middle">GIN Layers</text>
  <text x="550" y="260" class="label" text-anchor="middle">×5</text>
  <text x="880" y="230" class="label" text-anchor="middle">Global Add Pool</text>
  <text x="1210" y="230" class="label" text-anchor="middle">FC Projection</text>
  <text x="1210" y="260" class="label" text-anchor="middle">128-d Vector</text>

  <!-- Current model: protein branch -->
  <g fill="#e0ecff" stroke="#2563eb" class="box">
    <rect x="80" y="470" width="260" height="140" rx="24" />
    <rect x="420" y="470" width="260" height="140" rx="24" />
    <rect x="760" y="470" width="260" height="140" rx="24" />
  </g>
  <text x="210" y="530" class="label" text-anchor="middle">Pocket Sequence</text>
  <text x="210" y="560" class="label" text-anchor="middle">85 aa</text>
  <text x="550" y="530" class="label" text-anchor="middle">Protein Encoder</text>
  <text x="550" y="560" class="label" text-anchor="middle">CNN / ESM2</text>
  <text x="890" y="530" class="label" text-anchor="middle">Pooling / CLS</text>
  <text x="890" y="560" class="label" text-anchor="middle">128-d Vector</text>

  <!-- Current fusion -->
  <g fill="#ffe8d9" stroke="#ea580c" class="box">
    <rect x="1080" y="360" width="300" height="150" rx="24" />
    <rect x="1450" y="360" width="280" height="150" rx="24" />
    <rect x="1780" y="360" width="280" height="150" rx="24" />
  </g>
  <text x="1230" y="420" class="label" text-anchor="middle">Concat Ligand + Protein</text>
  <text x="1230" y="450" class="label" text-anchor="middle">Embeddings</text>
  <text x="1590" y="420" class="label" text-anchor="middle">Dense Layers</text>
  <text x="1590" y="450" class="label" text-anchor="middle">1024 → 256</text>
  <text x="1920" y="435" class="label" text-anchor="middle">Affinity Output</text>

  <!-- Current arrows -->
  <g stroke="#111827" stroke-width="4.5" fill="none" marker-end="url(#arrow)">
    <line x1="340" y1="240" x2="420" y2="240" />
    <line x1="680" y1="240" x2="760" y2="240" />
    <line x1="1020" y1="240" x2="1080" y2="240" />

    <line x1="340" y1="540" x2="420" y2="540" />
    <line x1="680" y1="540" x2="760" y2="540" />

    <line x1="1210" y1="310" x2="1210" y2="360" />
    <line x1="1380" y1="435" x2="1450" y2="435" />
    <line x1="1730" y1="435" x2="1780" y2="435" />
  </g>
  <path d="M 1210 310 C 1210 340 1180 360 1180 360" stroke="#111827" stroke-width="4.5" fill="none" marker-end="url(#arrow)" />
  <path d="M 1020 540 C 1100 540 1180 470 1180 470" stroke="#111827" stroke-width="4.5" fill="none" marker-end="url(#arrow)" />

  <!-- Proposed model: ligand branch -->
  <g fill="#e0ecff" stroke="#2563eb" class="box">
    <rect x="1380" y="170" width="280" height="140" rx="24" />
    <rect x="1740" y="170" width="280" height="140" rx="24" />
    <rect x="2100" y="170" width="260" height="140" rx="24" />
  </g>
  <text x="1520" y="230" class="label" text-anchor="middle">SMILES Graph</text>
  <text x="1520" y="260" class="label" text-anchor="middle">Nodes + Bond Features</text>
  <text x="1880" y="230" class="label" text-anchor="middle">Edge-aware GNN</text>
  <text x="1880" y="260" class="label" text-anchor="middle">GINE / PNA</text>
  <text x="2230" y="230" class="label" text-anchor="middle">Node Embeddings</text>

  <!-- Proposed model: protein branch -->
  <g fill="#e0ecff" stroke="#2563eb" class="box">
    <rect x="1380" y="470" width="280" height="140" rx="24" />
    <rect x="1740" y="470" width="300" height="140" rx="24" />
    <rect x="2120" y="470" width="280" height="140" rx="24" />
  </g>
  <text x="1520" y="530" class="label" text-anchor="middle">Pocket Sequence / Full Kinase</text>
  <text x="1890" y="530" class="label" text-anchor="middle">Contextual Encoder</text>
  <text x="1890" y="560" class="label" text-anchor="middle">ESM2 (tuned) / Transformer</text>
  <text x="2260" y="530" class="label" text-anchor="middle">Residue Embeddings</text>

  <!-- Proposed fusion -->
  <g fill="#ffe8d9" stroke="#ea580c" class="box">
    <rect x="2140" y="340" width="320" height="160" rx="24" />
    <rect x="2570" y="340" width="320" height="160" rx="24" />
    <rect x="3000" y="340" width="320" height="160" rx="24" />
  </g>
  <text x="2300" y="410" class="label" text-anchor="middle">Cross-Attention</text>
  <text x="2300" y="440" class="label" text-anchor="middle">Ligand ↔ Protein</text>
  <text x="2730" y="410" class="label" text-anchor="middle">Joint Pooling</text>
  <text x="2730" y="440" class="label" text-anchor="middle">Attention / Co-Pooling</text>
  <text x="3160" y="410" class="label" text-anchor="middle">Task Heads</text>
  <text x="3160" y="440" class="label" text-anchor="middle">Affinity + Aux Tasks</text>

  <!-- Proposed arrows -->
  <g stroke="#111827" stroke-width="4.5" fill="none" marker-end="url(#arrow)">
    <line x1="1660" y1="240" x2="1740" y2="240" />
    <line x1="2020" y1="240" x2="2100" y2="240" />
    <line x1="1660" y1="540" x2="1740" y2="540" />
    <line x1="2040" y1="540" x2="2120" y2="540" />
  </g>
  <path d="M 2360 240 C 2460 280 2460 360 2300 380" stroke="#111827" stroke-width="4.5" fill="none" marker-end="url(#arrow)" />
  <path d="M 2400 540 C 2500 520 2500 420 2320 380" stroke="#111827" stroke-width="4.5" fill="none" marker-end="url(#arrow)" />
  <g stroke="#111827" stroke-width="4.5" fill="none" marker-end="url(#arrow)">
    <line x1="2460" y1="420" x2="2570" y2="420" />
    <line x1="2890" y1="420" x2="3000" y2="420" />
  </g>
</svg>
